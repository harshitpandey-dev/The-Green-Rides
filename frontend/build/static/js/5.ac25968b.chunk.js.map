{"version":3,"sources":["pages/Rent.module.css","pages/Rent.js"],"names":["module","exports","Rent","props","history","useHistory","authCtx","useContext","AuthContext","useState","data","setData","done","setDone","rent","setRent","one","setOne","two","setTwo","useHttp","rentCycle","sendRequest","status","error","rentHandler","token","cycleid","userid","role","name","localStorage","removeItem","addCycle","useEffect","getItem","undefined","className","click","go","ScanComplete","setItem","classes","body","comp","scan","p"],"mappings":"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","file":"static/js/5.ac25968b.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"body\":\"Rent_body__2GGt-\",\"comp\":\"Rent_comp__2m8yu\",\"p\":\"Rent_p__2jYhR\"};","import { useContext, useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Scanner from '../components/QrScaner/Scanner';\nimport { rentCycle } from '../components/lib/api';\nimport useHttp from '../components/hooks/use-http';\nimport Button from '../components/UI/Button';\nimport AuthContext from '../store/auth-context';\nimport LoadingSpinner from '../components/UI/LoadingSpinner';\nimport classes from './Rent.module.css';\n\nconst Rent = (props) => {\n  const history = useHistory();\n  const authCtx = useContext(AuthContext);\n  const [data, setData] = useState(null);\n  const [done, setDone] = useState(false);\n  const [rent, setRent] = useState(true);\n  const [one, setOne] = useState(false);\n  const [two, setTwo] = useState(false);\n\n  //   console.log(authCtx);\n\n  let { sendRequest, status, error } = useHttp(rentCycle, false);\n  const rentHandler = () => {\n    sendRequest({\n      token: authCtx.token,\n      cycleid: data,\n      userid: authCtx.userid,\n      role: authCtx.role,\n      name: authCtx.name,\n    });\n    setDone(false);\n    setData(null);\n    localStorage.removeItem('scaned');\n    localStorage.removeItem('scandata');\n    if (!two && error) authCtx.addCycle(data);\n  };\n  useEffect(() => {\n    setData(localStorage.getItem('scandata'));\n    setDone(localStorage.getItem('scaned'));\n    if (localStorage.getItem('scandata') === 'undefined') {\n      setData(null);\n      setDone(false);\n      localStorage.removeItem('scaned');\n      localStorage.removeItem('scandata');\n    }\n  }, []);\n  useEffect(() => {\n    if (authCtx.role === 'admin') {\n      setOne(true);\n    }\n    if (authCtx.role === 'guard') {\n      setTwo(true);\n    }\n    if (authCtx.cycleid !== undefined && authCtx.cycleid !== '') {\n      setRent(false);\n    }\n  }, [\n    authCtx,\n    authCtx.role,\n    rent,\n    setRent,\n    setOne,\n    one,\n    two,\n    setTwo,\n    authCtx.cycleid,\n  ]);\n  //   console.log({ user: localStorage.getItem('data') });\n  if (status === 'pending') {\n    return (\n      <div className=\"centered\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n  if (error) {\n    return <p className=\"centered\">{error}</p>;\n  }\n  if (status === 'completed') {\n    return (\n      <div className=\"centered\">\n        <div>\n          <h1 className=\"centered\">\n            {two ? 'Cycle Returned' : 'Cycle Rented'}\n          </h1>\n        </div>\n        <div>\n          {two && (\n            <Button\n              click={() => {\n                setDone(false);\n                setData(null);\n                localStorage.removeItem('scaned');\n                localStorage.removeItem('scandata');\n                history.go(0);\n              }}\n            >\n              Return Another Cycle\n            </Button>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  const ScanComplete = (props) => {\n    setData(props);\n    localStorage.setItem('scandata', props);\n    setDone(true);\n    localStorage.setItem('scaned', true);\n  };\n  return (\n    <div className={classes.body}>\n      {!one && !two && (\n        <div className={classes.comp}>\n          {!rent && (\n            <h1 className=\"centered\">You have already rented one Cycle</h1>\n          )}\n          {rent && (\n            <>\n              {!done && <Scanner scan={ScanComplete} />}\n              {data && <p className={classes.p}>{data}</p>}\n              {done && <Button click={rentHandler}>Rent</Button>}\n              {done && (\n                <Button\n                  click={() => {\n                    setDone(false);\n                    setData(null);\n                    localStorage.removeItem('scaned');\n                    localStorage.removeItem('scandata');\n                  }}\n                >\n                  Scan Again\n                </Button>\n              )}\n            </>\n          )}\n        </div>\n      )}\n      {two && (\n        <div className={classes.comp}>\n          {!done && <Scanner scan={ScanComplete} />}\n          {data && <p className={classes.p}>{data}</p>}\n          {done && <Button click={rentHandler}>Return</Button>}\n          {done && (\n            <Button\n              click={() => {\n                setDone(false);\n                setData(null);\n                localStorage.removeItem('scaned');\n                localStorage.removeItem('scandata');\n              }}\n            >\n              Scan Again\n            </Button>\n          )}\n        </div>\n      )}\n      {one && !two && (\n        <div className={classes.comp}>\n          {!done && <Scanner scan={ScanComplete} />}\n          {data && <p className={classes.p}>{data}</p>}\n          {done && <Button click={rentHandler}>Admin</Button>}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Rent;\n"],"sourceRoot":""}